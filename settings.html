<!DOCTYPE html>
<html lang="en">

<head>
  <title>Data Ingest App</title>
  <script src='https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js'></script>
  <link rel='stylesheet' type='text/css' href='./semantic/dist/semantic.min.css'>
  <script src='./semantic/dist/semantic.min.js'></script>
</head>

<body>
  <h1>Settings</h1>

  <div class='ui form'>
    <h3>Database Name</h3>
    <div class='ui input'>
      <input type='text' placeholder='Database Name...' name='dbname' id='db-name'>
    </div>

    <h3>Database URL</h3>
    <div class='ui input'>
      <input type='text' value='localhost' placeholder='Database URL...'name='dburl' id='db-url'>
    </div>

    <h3>Database Port</h3>
    <div class='ui input'>
      <input type='text' value='27017' placeholder='Database Port...' name='dbport' id='db-port'>
    </div>

    <br><br>

    <button class='ui loading button' id='test-db-connection'>
      Test Connection
    </button>
    <button class='ui disabled primary button' id='save-settings'>
      Save
    </button>
    <div class="ui error message"></div>
  </div>
</body>

<script>

  let {remote} = require('electron');
  let path = require('path');
  let appPath = remote.app.getAppPath();
  const { settings } = require(path.resolve(appPath, './dist/settings.js'));
  // event sender/listeners
  document.getElementById('test-db-connection').addEventListener('click', () => {
    let payload = {
      name: document.getElementById('db-name').value,
      url: document.getElementById('db-url').value,
      port: document.getElementById('db-port').value
    };
    console.log(payload);
  })
  // validation logic for test and save buttons
  $('form')
  .form({
    on: 'blur',
    fields: {
      name: {
        identifier  : 'dbname',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please enter db name'
          }
        ]
      },
      url: {
        identifier  : 'dburl',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please enter db url'
          }
        ]
      },
      port: {
        identifier  : 'dbport',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please enter db port'
          },
          {
            type : 'number',
            prompt : 'Please enter a valid port number'
          }
        ]
      }
    }
  });

</script>

</html>